---
GENERATOR_VERSION: '1.0'
ANSIBLE_METADATA: |
    {
        'metadata_version': '1.1',
        'status': ['preview'],
        'supported_by': '<support_group>'
    }
NETWORK_OS: sonic
RESOURCE: pki
COPYRIGHT: Copyright 2022 Dell EMC
LICENSE: gpl-3.0.txt
DOCUMENTATION: |
  module: sonic_pki
  version_added: 2.3.0
  short_description: 'Manages PKI attributes of Enterprise Sonic'
  description: 'Manages PKI attributes of Enterprise Sonic'
  author: Eric Seifert
  notes:
    - 'Tested against Dell Enterprise SONiC 4.1.0'
  options:
    config:
      description: The provided configuration
      type: dict
      suboptions:
        trust-stores:
          description: Store of CA Certificates
          type: list
          elements: dict
          suboptions:
            name:
              type: str
              description: The name of the Trust Store
            ca-name:
              type: list
              elements: str
              description: List of CA certificates in the trust store.
        security-profiles:
          description: Application Security Profiles
          type: list
          elements: dict
          suboptions:
            profile-name:
              type: str
              description: Profile Name
            certificate-name:
              type: str
              description: Host Certificate Name
            trust-store:
              type: str
              description: Name of associated trust-store
            revocation-check:
              description: Require certificate revocation check succeeds
              type: bool
            peer-name-check:
              description: Require peer name is verified
              type: bool
            key-usage-check:
              description: Require key usage is enforced
              type: bool
            cdp-list:
              description: Global list of CDP's
              type: list
              elements: str
            ocsp-responder-list:
              description: Global list of OCSP responders
              type: list
              elements: str
    state:
      description:
        - The state of the configuration after module completion.
      type: str
      choices: ['merged', 'deleted', 'replaced', 'overridden']
      default: merged

EXAMPLES:
  - deleted_example_01.yaml
  - merged_example_01.yaml
  - overridden_example_01.yaml
  - replaced_example_01.yaml
